type: ""
name: car_counter
version: v0.0.1
scripts:
    - uuid: c701ddf0-dfd6-4577-bcfe-aa1c052481e1
      name: filter_by_size
      enabled: false
      source: |-
        function main(frame) {
        	var items = []
        	for (var i in frame.Items) {
        		var item = frame.Items[i];
        		// if (item.BBox.W() < 0.03) continue;
        		// rtmip.Debug(item.BBox.H())
        		if (item.BBox.H() > 0.6 || item.BBox.W() > 0.6) continue;
            if (item.BBox.H() < 0.1 || item.BBox.W() < 0.1) continue;
        		items.push(item);
        	}

        	frame.Items = items;

        	return true;
        }
    - uuid: 5e71f0a7-e27c-478c-bb98-f652fc40cc84
      name: bicycle_rename
      enabled: false
      source: |-
        // script created at 15:03:05 Dec 04
        function main(frame) {
        	
        	for (var i in frame.Items) {
        		var item = frame.Items[i]
        		if (item.Type == "bicycle") {
        		  item.Type = "motorbike";
        		}
        	}
        	
        	return true
        }
    - uuid: b5cb3bc6-cd6d-4d33-9908-163d5b049d23
      name: vehicle_counter
      enabled: false
      source: "var count = {\n\ttotal: 0,\n\tbus: 0,\n\tbike: 0,\n\tcar: 0,\n\ttruck: 0\n};\ncache = {}\n\nfunction main(frame) {\n  // frame.AddTextBox(\"Выехало всего: \" + count.total + \"\\nАвтомобилей: \" + count.car + \"\\nГрузовиков: \" + count.truck, 0.4, 0.8) \n  frame.AddTextBox(\"Queda total: \" + count.total + \"\\nCoches: \" + count.car + \"\\nCamiones: \" + count.truck, 0.4, 0.8) \n\n\tfor (var i in frame.Items) {\n\t\tvar item = frame.Items[i];\n\n\n\t\t\n\t\tif (item.Prob < 0.1) {\n\t\t\t// item.State = \"hide\";\n\t\t\tcontinue\n\t\t}\n    \n\t\titem.State = \"pass\";\n\n\t\tvar c = false;\n\t\tif (!c) {\n\t\t\tcount.total++;\n\t\t\tif (item.Type == \"bus\" || item.Type == \"van\") {\n        count.bus += 1;\n\t\t\t}\n\t\t\telse if (item.Type == \"motorbike\" || item.Type == \"bicycle\") {\n\t\t\t  count.bike += 1;\n\t\t\t}\n\t\t\telse if (item.Type == \"truck\") {\n\t\t\t  count.truck += 1;\n\t\t\t}\n\t\t\telse if (item.Type == \"car\") {\n\t\t\t  count.car += 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}"
    - uuid: 8231dc96-c452-42ab-aec2-c59308c61a40
      name: car_idle
      enabled: false
      source: "var MIN_DELTA = 0.07\r\nvar rm_from_cache_timeout = 55\r\nvar rm_from_cache_noupdates_timeout = 5\r\n// @public type:number default:40\r\nvar move_detect_period = 50\r\n\r\nvar camcache = {\r\n\t// camera = {\r\n\t// \tid: {\r\n\t// \t}\r\n\t// }\r\n}\r\n\r\n\r\nfunction getCache(frame) {\r\n\tvar cache = camcache[frame.Camera.ID]\r\n\tif (!cache) {\r\n\t\tcache = {}\r\n\t\tcamcache[frame.Camera.ID] = cache\r\n\t}\r\n\treturn cache\r\n}\r\n\r\n\r\n\r\nfunction main(frame) {\r\n\tvar cache = getCache(frame)\r\n\tvar current_timestamp = frame.Time\r\n\tvar need_report = false\r\n\r\n\r\n\tfor (var c_item in cache) {\r\n\t\tif (current_timestamp - cache[c_item]['first_detection'] > rm_from_cache_timeout ||\r\n\t\t\tcurrent_timestamp - cache[c_item]['last_update'] > rm_from_cache_noupdates_timeout) {\r\n\t\t\tdelete cache[c_item];\r\n\t\t}\r\n\t}\r\n\r\n// \trtmip.Debugf(\"%#v\", current_timestamp)\r\n\tfor (var i in frame.Items) {\r\n\t\tvar item = frame.Items[i]\r\n\t\t\r\n\t\tif (item.ID in cache) {\r\n\t\t\tcache[item.ID][\"last_update\"] = current_timestamp\r\n\t\t\tvar xy = item.BBox.Center()\r\n\r\n\t\t\tif (Math.abs(cache[item.ID][\"position\"][0] - xy[0]) > MIN_DELTA * item.BBox.W() ||\r\n\t\t\t\tMath.abs(cache[item.ID][\"position\"][1] - xy[1]) > MIN_DELTA * item.BBox.H()) {\r\n\t\t\t\tcache[item.ID][\"first_detection\"] = current_timestamp\r\n\t\t\t\tcache[item.ID][\"position\"] = xy\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (current_timestamp - cache[item.ID][\"first_detection\"] >= move_detect_period) {\r\n\t\t\t\titem.State = \"fail\"\r\n\t\t\t\tframe.State = \"fail\"\r\n\t\t\t\t// frame.Status = \"Автомобиль без движения\"\r\n\t\t\t\tframe.Status = \"Vehiculo sin movimiento\"\r\n\r\n\t\t\t\tif (!cache[item.ID][\"reported\"]) {\r\n\t\t\t\t\t// rtmip.Debugf(\"Creating report Standing people: %#v\", current_timestamp)\r\n\t\t\t\t\tcache[item.ID][\"reported\"] = true\r\n\t\t\t\t\tcreateEvent(frame, item)\r\n\t\t\t\t\tneed_report = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\telse {\r\n\t\t\tcache[item.ID] = {\r\n\t\t\t\t\"prob\": item.Prob,\r\n\t\t\t\t\"first_detection\": current_timestamp,\r\n\t\t\t\t\"last_update\": current_timestamp,\r\n\t\t\t\t\"position\": item.BBox.Center(),\r\n\t\t\t\t\"num_of_detects\": 1,\r\n\t\t\t\t\"reported\": false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn need_report\r\n}\r\n\r\n\r\nfunction createEvent(frame, item) {\r\n\tframe.Save()\r\n\tvar event = rtmip.NewEvent(frame, item)\r\n\tevent.Status = frame.Status\r\n\tevent.State = frame.State\r\n\t// event.Alert = true;\r\n\r\n\trtmip.StoreEvent(event)\r\n\treturn true\r\n}"
    - uuid: c701ddf0-dfd6-4577-bcfe-aa1c052481e1
      name: filter_by_size
      enabled: false
      source: |-
        function main(frame) {
        	var items = []
        	for (var i in frame.Items) {
        		var item = frame.Items[i];
        		// if (item.BBox.W() < 0.03) continue;
        		// rtmip.Debug(item.BBox.H())
        		if (item.BBox.H() > 0.6 || item.BBox.W() > 0.6) continue;
            if (item.BBox.H() < 0.1 || item.BBox.W() < 0.1) continue;
        		items.push(item);
        	}

        	frame.Items = items;

        	return true;
        }
    - uuid: 88dfec40-5f57-4a1a-a460-00ec336e41ef
      name: cashier_away
      enabled: false
      source: "// script created at 12:18:16 июнь 15\nfunction main(frame) {\n\tvar counter = 0\n\tfor (var i in frame.Items) {\n\t  \n\t\tvar item = frame.Items[i]\n\t\tif (item.Type == \"person\") {\n\t\t  item.State = \"pass\"\n\t\t  counter ++\n\t\t}\n\t}\n\t\n\tif (counter == 0) {\n\t  frame.State = \"fail\"\n\t\t// frame.Status = \"Кассир не на месте\"\n\t\tframe.Status = \"El cajero esta ausente\"\n\t}\n\t\n\treturn true\n}"
    - uuid: c701ddf0-dfd6-4577-bcfe-aa1c052481e1
      name: filter_by_size
      enabled: false
      source: |-
        function main(frame) {
        	var items = []
        	for (var i in frame.Items) {
        		var item = frame.Items[i];
        		// if (item.BBox.W() < 0.03) continue;
        		// rtmip.Debug(item.BBox.H())
        		if (item.BBox.H() > 0.6 || item.BBox.W() > 0.6) continue;
            if (item.BBox.H() < 0.1 || item.BBox.W() < 0.1) continue;
        		items.push(item);
        	}

        	frame.Items = items;

        	return true;
        }
    - uuid: 031348fe-6b25-468f-b3cd-a10532d8281a
      name: person_in_staff_room
      enabled: false
      source: "// script created at 12:18:16 июнь 15\nfunction main(frame) {\n\tvar counter = 0\n\tfor (var i in frame.Items) {\n\t  \n\t\tvar item = frame.Items[i]\n\t\tif (item.Type == \"person\") {\n\t\t  // item.State = \"pass\"\n\t\t  counter ++\n\t\t}\n\t}\n\t\n\tif (counter > 0) {\n\t  frame.State = \"fail\"\n\t\t// frame.Status = \"Человек в служебном помещении\"\n\t\tframe.Status = \"Persona en oficina\"\n\t}\n\t\n\treturn true\n}"
    - uuid: b0fd61df-a7fb-413a-b125-9c43e4218ee7
      name: empty_filling_station_counter
      enabled: false
      source: "// script created at 12:18:16 июнь 15\nfunction main(frame) {\n\tvar counter = 0\n\tfor (var i in frame.Items) {\n\t  \n\t\tvar item = frame.Items[i]\n\t\tif ((item.Type == \"car\") || (item.Type == \"truck\")) {\n\t\t  item.State = \"pass\"\n\t\t  counter ++\n\t\t}\n\t}\n\n  if (counter > 2) {\n    counter = 2\n  }\n\t\n\tvar empty_place = 2 - counter\n\t\n// \tframe.AddTextBox(\"Свободных мест на заправке: \" + empty_place + \" из 2\", 0.35, 0.1) \n\tframe.AddTextBox(\"Asientos vacíos en la gasolinera: \" + empty_place + \" de 2\", 0.35, 0.1) \n\t\n\treturn true\n}"
    - uuid: 9c8c762e-cc5a-4871-b5e7-0710d18dd260
      name: mosgortrans_exit
      enabled: false
      source: "var count = {\n\ttotal: 0,\n\tbus: 0,\n\tbike: 0,\n\tcar: 0,\n\tperson: 0,\n\ttruck: 0\n};\ncache = {}\n\nfunction main(frame) {\n  // frame.AddTextBox(\"Выехало всего: \" + count.total + \"\\nАвтомобилей: \" + count.car + \"\\nГрузовиков: \" + count.truck, 0.4, 0.8) \n  frame.AddTextBox(\"Вышло человек: \" + count.person, 0.6, 0.8) \n\n\tfor (var i in frame.Items) {\n\t\tvar item = frame.Items[i];\n\n\n\t\t\n\t\tif (item.Prob < 0.1) {\n\t\t\t// item.State = \"hide\";\n\t\t\tcontinue\n\t\t}\n    \n\t\titem.State = \"pass\";\n\n\t\tif (item.Type == \"head\") {\n      count.person += 0;\n\t\t}\n\t}\n\treturn true;\n}"
    - uuid: c701ddf0-dfd6-4577-bcfe-aa1c052481e1
      name: filter_by_size
      enabled: false
      source: |-
        function main(frame) {
        	var items = []
        	for (var i in frame.Items) {
        		var item = frame.Items[i];
        		// if (item.BBox.W() < 0.03) continue;
        		// rtmip.Debug(item.BBox.H())
        		if (item.BBox.H() > 0.6 || item.BBox.W() > 0.6) continue;
            if (item.BBox.H() < 0.1 || item.BBox.W() < 0.1) continue;
        		items.push(item);
        	}

        	frame.Items = items;

        	return true;
        }
    - uuid: 36323989-8d86-4e9a-8d1a-e0f8d3326883
      name: mosgortrans_enter
      enabled: false
      source: "var cache = {\n  'timestamp': 0,\n  'counter': 0\n}\n\nfunction main(frame) {\n  \n  if (frame.Time - cache[\"timestamp\"] > 10000) {\n    cache['counter'] = 0\n  }\n  cache['timestamp'] = frame.Time\n  \n  // frame.AddTextBox(\"Выехало всего: \" + count.total + \"\\nАвтомобилей: \" + count.car + \"\\nГрузовиков: \" + count.truck, 0.4, 0.8) \n  frame.AddTextBox(\"Вошло человек: \" + cache['counter'], 0.3, 0.8) \n\n\tfor (var i in frame.Items) {\n\t\tvar item = frame.Items[i];\n\t\t\n\t\tif (item.Prob < 0.1) {\n\t\t\t// item.State = \"hide\";\n\t\t\tcontinue\n\t\t}\n    \n\t\titem.State = \"pass\";\n\n\t\tif (item.Type == \"head\") {\n      cache['counter'] += 1;\n\t\t}\n\t}\n\treturn true;\n}"
    - uuid: 619255fc-e1c2-4b34-bb3e-117534dd46e9
      name: person_in_danger_zone
      enabled: false
      source: "function main(frame) {\n\tvar counter = 0\n\tfor (var i in frame.Items) {\n\t  \n\t\tvar item = frame.Items[i]\n\t\tif (item.Type == \"person\") {\n\t\t  // item.State = \"pass\"\n\t\t  counter ++\n\t\t}\n\t}\n\t\n\tif (counter > 0) {\n\t  frame.State = \"fail\"\n\t\tframe.Status = \"Человек в опасной зоне\"\n\t}\n\t\n\treturn true\n}"
    - uuid: c701ddf0-dfd6-4577-bcfe-aa1c052481e1
      name: filter_by_size
      enabled: false
      source: |-
        function main(frame) {
        	var items = []
        	for (var i in frame.Items) {
        		var item = frame.Items[i];
        		// if (item.BBox.W() < 0.03) continue;
        		// rtmip.Debug(item.BBox.H())
        		if (item.BBox.H() > 0.6 || item.BBox.W() > 0.6) continue;
            if (item.BBox.H() < 0.1 || item.BBox.W() < 0.1) continue;
        		items.push(item);
        	}

        	frame.Items = items;

        	return true;
        }
    - uuid: 36323989-8d86-4e9a-8d1a-e0f8d3326883
      name: mosgortrans_enter
      enabled: false
      source: "var cache = {\n  'timestamp': 0,\n  'counter': 0\n}\n\nfunction main(frame) {\n  \n  if (frame.Time - cache[\"timestamp\"] > 10000) {\n    cache['counter'] = 0\n  }\n  cache['timestamp'] = frame.Time\n  \n  // frame.AddTextBox(\"Выехало всего: \" + count.total + \"\\nАвтомобилей: \" + count.car + \"\\nГрузовиков: \" + count.truck, 0.4, 0.8) \n  frame.AddTextBox(\"Вошло человек: \" + cache['counter'], 0.3, 0.8) \n\n\tfor (var i in frame.Items) {\n\t\tvar item = frame.Items[i];\n\t\t\n\t\tif (item.Prob < 0.1) {\n\t\t\t// item.State = \"hide\";\n\t\t\tcontinue\n\t\t}\n    \n\t\titem.State = \"pass\";\n\n\t\tif (item.Type == \"head\") {\n      cache['counter'] += 1;\n\t\t}\n\t}\n\treturn true;\n}"
    - uuid: c701ddf0-dfd6-4577-bcfe-aa1c052481e1
      name: filter_by_size
      enabled: false
      source: |-
        function main(frame) {
        	var items = []
        	for (var i in frame.Items) {
        		var item = frame.Items[i];
        		// if (item.BBox.W() < 0.03) continue;
        		// rtmip.Debug(item.BBox.H())
        		if (item.BBox.H() > 0.6 || item.BBox.W() > 0.6) continue;
            if (item.BBox.H() < 0.1 || item.BBox.W() < 0.1) continue;
        		items.push(item);
        	}

        	frame.Items = items;

        	return true;
        }
    - uuid: 0ff58f11-11ad-4a45-bb29-ba210e62f7b2
      name: car_entrance_check
      enabled: false
      source: "function main(frame) {\n\tvar carCounter = 0\n\tvar personCounter = 0\n\tfor (var i in frame.Items) {\n\t  \n\t\tvar item = frame.Items[i]\n\t\tif (item.Type == \"car\") {\n\t\t  // item.State = \"pass\"\n\t\t  carCounter ++\n\t\t}\n\t\tif (item.Type == \"person\") {\n\t\t  // item.State = \"pass\"\n\t\t  personCounter ++\n\t\t}\n\t}\n\t\n\tif (carCounter > 0) {\n\t  frame.AddTextBox(\"Автомобиль в зоне проверки\", 0.35, 0.1)\n\t // frame.State = \"fail\"\n\t\t// // frame.Status = \"Человек в служебном помещении\"\n\t\t// frame.Status = \"Persona en oficina\"\n\t}\n\t\n\tif (personCounter > 0) {\n\t  frame.AddTextBox(\"Сотрудник в зоне проверки\", 0.35, 0.8)\n\t // frame.State = \"fail\"\n\t\t// // frame.Status = \"Человек в служебном помещении\"\n\t\t// frame.Status = \"Persona en oficina\"\n\t}\n\t\n\treturn true\n}"
detectors:
    - uuid: 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
      name: transport_detector
      enabled: true
      type: items
      addrs:
        - 10.6.0.101:60800
      status:
        version: "1.0"
        name: transport_detector
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - car
                - motorbike
                - bus
                - truck
                - bicycle
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 416
        height: 416
      cmd: ""
    - uuid: 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
      name: transport_detector
      enabled: true
      type: items
      addrs:
        - 10.6.0.101:60800
      status:
        version: "1.0"
        name: transport_detector
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - car
                - motorbike
                - bus
                - truck
                - bicycle
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 416
        height: 416
      cmd: ""
    - uuid: 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
      name: transport_detector
      enabled: true
      type: items
      addrs:
        - 10.6.0.101:60800
      status:
        version: "1.0"
        name: transport_detector
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - car
                - motorbike
                - bus
                - truck
                - bicycle
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 416
        height: 416
      cmd: ""
    - uuid: 61aa66f4-76c9-450e-917d-434345de32d5
      name: person-head-detector
      enabled: false
      type: items
      addrs:
        - 127.0.0.1:65530
      status:
        version: "1.4"
        name: person-head-detector-torch
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - head
                - not_person
                - not_head
                - animal
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 608
        height: 608
      cmd: ""
    - uuid: 69316dc5-6129-4b53-bdb5-c403774fd17c
      name: transport_detector_@quiron
      enabled: true
      type: items
      addrs:
        - 10.6.75.89:63550
      status:
        version: "1.4"
        name: transport-detector-torch
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - bicycle
                - motorbike
                - car
                - van
                - truck
                - bus
                - tractor
                - excavator
                - forklifts
                - no_person
                - truck_special
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 608
        height: 608
      cmd: ""
    - uuid: 61aa66f4-76c9-450e-917d-434345de32d5
      name: person-head-detector
      enabled: false
      type: items
      addrs:
        - 127.0.0.1:65530
      status:
        version: "1.4"
        name: person-head-detector-torch
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - head
                - not_person
                - not_head
                - animal
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 608
        height: 608
      cmd: ""
    - uuid: 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
      name: transport_detector
      enabled: true
      type: items
      addrs:
        - 10.6.0.101:60800
      status:
        version: "1.0"
        name: transport_detector
        type: detector
        path: /cvpredict
        output:
            types:
                - person
                - car
                - motorbike
                - bus
                - truck
                - bicycle
            colors: []
            attributes: []
        imagetypes:
            - ALL
        width: 416
        height: 416
      cmd: ""
analytics:
    - uuid: 72350a4d-c1f7-46dc-98a5-904205d5b54b
      name: Car_counter
      desc: Counting cars which drive through zones
      enabled: true
      framerate: 20
      passhash: []
      links:
        detector-CNH_LQq0l:
            "true":
                - filter-JBZZjh1K5
                - filter-zsF8FdXyg
            "false": []
        filter-JBZZjh1K5:
            "true":
                - script-6NqqcR7pS
            "false": []
        filter-zsF8FdXyg:
            "true":
                - script-SK6D0_2Tz
            "false": []
        region-np-YX1o01:
            "true":
                - script-uhUdaR8Iy
            "false":
                - script-uhUdaR8Iy
        script-6NqqcR7pS:
            "true":
                - tracking-zmmjmVwcb
            "false": []
        script-SK6D0_2Tz:
            "true":
                - script-6NqqcR7pS
            "false": []
        script-uhUdaR8Iy:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-CNH_LQq0l
            "false": []
        tracking-zmmjmVwcb:
            "true":
                - region-np-YX1o01
                - result
            "false": []
      blocks:
        detector-CNH_LQq0l:
            id: detector-CNH_LQq0l
            type: detector
            data:
                id: 47
                type: detector
            position:
                x: -380
                "y": -41
            uuid:
                - 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
        filter-JBZZjh1K5:
            id: filter-JBZZjh1K5
            type: filter
            data:
                percentprob: "90"
                type: filter
                types:
                    - van
                    - truck
                    - car
            position:
                x: -140
                "y": 50
        filter-zsF8FdXyg:
            id: filter-zsF8FdXyg
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - motorbike
                    - motorcycle
                    - bicycle
            position:
                x: -140
                "y": -240
        region-np-YX1o01:
            id: region-np-YX1o01
            type: region
            data:
                action: input
                anchor: 5
                regionnames:
                    - car_l
                    - car_r
                    - cars_l
                    - car
                    - Lukoil_cars_counter
                type: region
            position:
                x: 800
                "y": -331
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1330
                "y": -70
        script-6NqqcR7pS:
            id: script-6NqqcR7pS
            type: script
            data:
                id: 3
                type: script
            position:
                x: 290
                "y": -70
            uuid:
                - c701ddf0-dfd6-4577-bcfe-aa1c052481e1
        script-SK6D0_2Tz:
            id: script-SK6D0_2Tz
            type: script
            data:
                id: 4
                type: script
            position:
                x: 60
                "y": -240
            uuid:
                - 5e71f0a7-e27c-478c-bb98-f652fc40cc84
        script-uhUdaR8Iy:
            id: script-uhUdaR8Iy
            type: script
            data:
                id: 5
                type: script
            position:
                x: 1040
                "y": -200
            uuid:
                - b5cb3bc6-cd6d-4d33-9908-163d5b049d23
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -750
                "y": -40
        tracking-zmmjmVwcb:
            id: tracking-zmmjmVwcb
            type: tracking
            data:
                scale: "2"
                tracks: true
                type: tracking
            position:
                x: 510
                "y": -70
    - uuid: 9ec42cc9-6045-4288-b6ea-220fda0a8ffc
      name: Car_idle
      enabled: true
      framerate: 1
      passhash: []
      links:
        IOU-zjb4kAuho:
            "true":
                - region-kRjt60cDG
            "false": []
        detector-dSil1urRu:
            "true":
                - filter-bSY0A_br8
            "false": []
        filter-bSY0A_br8:
            "true":
                - IOU-zjb4kAuho
            "false": []
        region-kRjt60cDG:
            "true":
                - script-Dn2zDPg7t3
            "false": []
        script-Dn2zDPg7t3:
            "true":
                - result
            "false":
                - result
        source:
            "true":
                - detector-dSil1urRu
            "false": []
        tracking-AoEfx1GXz:
            "true": []
            "false": []
      blocks:
        IOU-zjb4kAuho:
            id: IOU-zjb4kAuho
            type: extscript
            data:
                desc: IOU
                error: null
                exec: ./iou
                icon: tracking.png
                id: iou
                name: IOU
                serialize: ""
                transport: ""
                type: extscript
                values:
                    ioutr: "0.5"
                variables:
                    - class: ""
                      data: null
                      default: 2
                      desc: ""
                      label: Max lost detections
                      name: maxlost
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 0.3
                      desc: ""
                      label: IOU threshold
                      name: ioutr
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                version: ""
            position:
                x: 570
                "y": -130
        detector-dSil1urRu:
            id: detector-dSil1urRu
            type: detector
            data:
                id: 47
                type: detector
            position:
                x: 100
                "y": 100
            uuid:
                - 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
        filter-bSY0A_br8:
            id: filter-bSY0A_br8
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - car
                    - truck
            position:
                x: 310
                "y": 100
        region-kRjt60cDG:
            id: region-kRjt60cDG
            type: region
            data:
                anchor: 5
                regionnames:
                    - car_idle
                type: region
            position:
                x: 820
                "y": 100
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1380
                "y": 100
        script-Dn2zDPg7t3:
            id: script-Dn2zDPg7t3
            type: script
            data:
                id: 7
                type: script
                values:
                    move_detect_period: "50"
            position:
                x: 1130
                "y": 100
            uuid:
                - 8231dc96-c452-42ab-aec2-c59308c61a40
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -120
                "y": 100
        tracking-AoEfx1GXz:
            id: tracking-AoEfx1GXz
            type: tracking
            data:
                scale: 2
                type: tracking
            position:
                x: 570
                "y": 100
    - uuid: 03d6ffcf-c639-40e2-b2e4-babed4bda982
      name: Cashier_away
      enabled: true
      framerate: 1
      passhash: []
      links:
        detector-CNH_LQq0l:
            "true":
                - filter-zsF8FdXyg
            "false": []
        filter-zsF8FdXyg:
            "true":
                - tracking-zmmjmVwcb
            "false": []
        region-np-YX1o01:
            "true":
                - script-uhUdaR8Iy
            "false":
                - script-uhUdaR8Iy
        script-6NqqcR7pS:
            "true": []
            "false": []
        script-uhUdaR8Iy:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-CNH_LQq0l
            "false": []
        tracking-zmmjmVwcb:
            "true":
                - region-np-YX1o01
            "false": []
      blocks:
        detector-CNH_LQq0l:
            id: detector-CNH_LQq0l
            type: detector
            data:
                id: 11
                type: detector
            position:
                x: -500
                "y": -41
            uuid:
                - ee0e94f1-502d-4433-8b78-1de2b0038a54
        filter-zsF8FdXyg:
            id: filter-zsF8FdXyg
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - motorcycle
                    - person
            position:
                x: -200
                "y": -40
        region-np-YX1o01:
            id: region-np-YX1o01
            type: region
            data:
                action: ""
                anchor: 5
                regionnames:
                    - car_l
                    - car_r
                    - cars_l
                    - car
                    - cashier_away
                type: region
            position:
                x: 570
                "y": -41
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1150
                "y": -40
        script-6NqqcR7pS:
            id: script-6NqqcR7pS
            type: script
            data:
                id: 3
                type: script
            position:
                x: 40
                "y": -190
            uuid:
                - c701ddf0-dfd6-4577-bcfe-aa1c052481e1
        script-uhUdaR8Iy:
            id: script-uhUdaR8Iy
            type: script
            data:
                id: 8
                type: script
            position:
                x: 850
                "y": -40
            uuid:
                - 88dfec40-5f57-4a1a-a460-00ec336e41ef
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -750
                "y": -40
        tracking-zmmjmVwcb:
            id: tracking-zmmjmVwcb
            type: tracking
            data:
                scale: "2"
                tracks: true
                type: tracking
            position:
                x: 270
                "y": -40
    - uuid: dd1e8e30-6528-48de-93e6-85894c0d65b0
      name: Person_in_staff_room
      enabled: true
      framerate: 10
      passhash: []
      links:
        detector-CNH_LQq0l:
            "true":
                - filter-zsF8FdXyg
            "false": []
        filter-zsF8FdXyg:
            "true":
                - tracking-zmmjmVwcb
            "false": []
        region-np-YX1o01:
            "true":
                - script-uhUdaR8Iy
            "false":
                - script-uhUdaR8Iy
        script-6NqqcR7pS:
            "true": []
            "false": []
        script-uhUdaR8Iy:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-CNH_LQq0l
            "false": []
        tracking-zmmjmVwcb:
            "true":
                - region-np-YX1o01
            "false": []
      blocks:
        detector-CNH_LQq0l:
            id: detector-CNH_LQq0l
            type: detector
            data:
                id: 11
                type: detector
            position:
                x: -500
                "y": -41
            uuid:
                - ee0e94f1-502d-4433-8b78-1de2b0038a54
        filter-zsF8FdXyg:
            id: filter-zsF8FdXyg
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - motorcycle
                    - person
            position:
                x: -200
                "y": -40
        region-np-YX1o01:
            id: region-np-YX1o01
            type: region
            data:
                action: ""
                anchor: 5
                regionnames:
                    - car_l
                    - car_r
                    - cars_l
                    - car
                    - person_in_staff_room
                type: region
            position:
                x: 570
                "y": -41
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1150
                "y": -40
        script-6NqqcR7pS:
            id: script-6NqqcR7pS
            type: script
            data:
                id: 3
                type: script
            position:
                x: 40
                "y": -190
            uuid:
                - c701ddf0-dfd6-4577-bcfe-aa1c052481e1
        script-uhUdaR8Iy:
            id: script-uhUdaR8Iy
            type: script
            data:
                id: 9
                type: script
            position:
                x: 850
                "y": -40
            uuid:
                - 031348fe-6b25-468f-b3cd-a10532d8281a
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -750
                "y": -40
        tracking-zmmjmVwcb:
            id: tracking-zmmjmVwcb
            type: tracking
            data:
                scale: "2"
                tracks: true
                type: tracking
            position:
                x: 270
                "y": -40
    - uuid: 93a0a8a0-3dd0-4d9d-acb0-68eb45e84e33
      name: Empty_filling_station_counter
      enabled: true
      framerate: 1
      passhash: []
      links:
        detector-dSil1urRu:
            "true":
                - filter-bSY0A_br8
            "false": []
        filter-bSY0A_br8:
            "true":
                - tracking-AoEfx1GXz
            "false": []
        region-kRjt60cDG:
            "true":
                - script-Dn2zDPg7t3
            "false":
                - script-Dn2zDPg7t3
        script-Dn2zDPg7t3:
            "true":
                - result
            "false":
                - result
        source:
            "true":
                - detector-dSil1urRu
            "false": []
        tracking-AoEfx1GXz:
            "true":
                - region-kRjt60cDG
            "false": []
      blocks:
        detector-dSil1urRu:
            id: detector-dSil1urRu
            type: detector
            data:
                id: 47
                type: detector
            position:
                x: 100
                "y": 100
            uuid:
                - 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
        filter-bSY0A_br8:
            id: filter-bSY0A_br8
            type: filter
            data:
                percentprob: "50"
                type: filter
                types:
                    - car
                    - truck
            position:
                x: 310
                "y": 100
        region-kRjt60cDG:
            id: region-kRjt60cDG
            type: region
            data:
                anchor: 5
                regionnames:
                    - empty_filling_station
                type: region
            position:
                x: 820
                "y": 100
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1430
                "y": 100
        script-Dn2zDPg7t3:
            id: script-Dn2zDPg7t3
            type: script
            data:
                id: 10
                type: script
            position:
                x: 1130
                "y": 100
            uuid:
                - b0fd61df-a7fb-413a-b125-9c43e4218ee7
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -120
                "y": 100
        tracking-AoEfx1GXz:
            id: tracking-AoEfx1GXz
            type: tracking
            data:
                scale: 2
                type: tracking
            position:
                x: 570
                "y": 100
    - uuid: e7b22333-1401-46fa-976f-ad40f9d91034
      name: Mosgortrans_counter
      desc: Counting people entering and leaving tram
      enabled: true
      framerate: 20
      passhash: []
      links:
        SORT-1nHEP8YDM:
            "true":
                - line-crossing-zAC4OHlOm
                - result
                - line-crossing-rckzcfetB
            "false": []
        detector-CNH_LQq0l:
            "true":
                - filter-JBZZjh1K5
            "false": []
        filter-JBZZjh1K5:
            "true":
                - script-6NqqcR7pS
            "false": []
        line-crossing-rckzcfetB:
            "true":
                - script-09jntzDc3
            "false":
                - script-09jntzDc3
        line-crossing-zAC4OHlOm:
            "true":
                - script-uhUdaR8Iy
            "false":
                - script-uhUdaR8Iy
        region-np-YX1o01:
            "true": []
            "false": []
        script-6NqqcR7pS:
            "true":
                - SORT-1nHEP8YDM
            "false": []
        script-09jntzDc3:
            "true":
                - result
            "false": []
        script-uhUdaR8Iy:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-CNH_LQq0l
            "false": []
        tracking-zmmjmVwcb:
            "true": []
            "false": []
      blocks:
        SORT-1nHEP8YDM:
            id: SORT-1nHEP8YDM
            type: extscript
            data:
                desc: SORT
                error: null
                exec: ./sort
                icon: download.png
                id: sort
                name: SORT
                serialize: ""
                transport: ""
                type: extscript
                values: null
                variables:
                    - class: ""
                      data: null
                      default: false
                      desc: ""
                      label: Use prediction on unmatched trackers
                      name: predunm
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: checkbox
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 3
                      desc: ""
                      label: Max predicts without update
                      name: maxpred
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 3
                      desc: ""
                      label: Max unmatches before delete
                      name: maxunm
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 0.4
                      desc: ""
                      label: IOU threshold
                      name: ioutr
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                version: ""
            position:
                x: 510
                "y": -90
        detector-CNH_LQq0l:
            id: detector-CNH_LQq0l
            type: detector
            data:
                id: 54
                type: detector
            position:
                x: -380
                "y": -41
            uuid:
                - ee0e94f1-502d-4433-8b78-1de2b0038a54
        filter-JBZZjh1K5:
            id: filter-JBZZjh1K5
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - van
                    - head
            position:
                x: -80
                "y": -40
        line-crossing-rckzcfetB:
            id: line-crossing-rckzcfetB
            type: line-crossing
            data:
                linenames:
                    - mos_exit
                type: line-crossing
            position:
                x: 770
                "y": 20
        line-crossing-zAC4OHlOm:
            id: line-crossing-zAC4OHlOm
            type: line-crossing
            data:
                linenames:
                    - mos_enter
                type: line-crossing
            position:
                x: 780
                "y": -260
        region-np-YX1o01:
            id: region-np-YX1o01
            type: region
            data:
                action: input
                anchor: 5
                regionnames:
                    - car_l
                    - car_r
                    - cars_l
                    - car
                type: region
            position:
                x: 780
                "y": -541
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1530
                "y": -80
        script-6NqqcR7pS:
            id: script-6NqqcR7pS
            type: script
            data:
                id: 3
                type: script
            position:
                x: 210
                "y": -40
            uuid:
                - c701ddf0-dfd6-4577-bcfe-aa1c052481e1
        script-09jntzDc3:
            id: script-09jntzDc3
            type: script
            data:
                id: 14
                type: script
            position:
                x: 1160
                "y": 10
            uuid:
                - 9c8c762e-cc5a-4871-b5e7-0710d18dd260
        script-uhUdaR8Iy:
            id: script-uhUdaR8Iy
            type: script
            data:
                id: 13
                type: script
            position:
                x: 1160
                "y": -340
            uuid:
                - 36323989-8d86-4e9a-8d1a-e0f8d3326883
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -750
                "y": -40
        tracking-zmmjmVwcb:
            id: tracking-zmmjmVwcb
            type: tracking
            data:
                scale: "2"
                tracks: true
                type: tracking
            position:
                x: 500
                "y": -490
    - uuid: 20065bdf-ae76-4029-8d53-693d5f5bf8d9
      name: Makita_person_in_danger_zone
      enabled: true
      framerate: 10
      passhash: []
      links:
        detector-CNH_LQq0l:
            "true":
                - filter-zsF8FdXyg
            "false": []
        filter-zsF8FdXyg:
            "true":
                - tracking-zmmjmVwcb
            "false": []
        region-np-YX1o01:
            "true":
                - script-uhUdaR8Iy
            "false":
                - script-uhUdaR8Iy
        script-6NqqcR7pS:
            "true": []
            "false": []
        script-uhUdaR8Iy:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-CNH_LQq0l
            "false": []
        tracking-zmmjmVwcb:
            "true":
                - region-np-YX1o01
            "false": []
      blocks:
        detector-CNH_LQq0l:
            id: detector-CNH_LQq0l
            type: detector
            data:
                id: 65
                type: detector
            position:
                x: -500
                "y": -41
            uuid:
                - 61aa66f4-76c9-450e-917d-434345de32d5
        filter-zsF8FdXyg:
            id: filter-zsF8FdXyg
            type: filter
            data:
                percentprob: "50"
                type: filter
                types:
                    - motorcycle
                    - person
            position:
                x: -200
                "y": -40
        region-np-YX1o01:
            id: region-np-YX1o01
            type: region
            data:
                action: ""
                anchor: 5
                regionnames:
                    - car_l
                    - car_r
                    - cars_l
                    - car
                    - makita_danger_zone
                type: region
            position:
                x: 570
                "y": -41
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1150
                "y": -40
        script-6NqqcR7pS:
            id: script-6NqqcR7pS
            type: script
            data:
                id: 3
                type: script
            position:
                x: 40
                "y": -190
            uuid:
                - c701ddf0-dfd6-4577-bcfe-aa1c052481e1
        script-uhUdaR8Iy:
            id: script-uhUdaR8Iy
            type: script
            data:
                id: 18
                type: script
            position:
                x: 850
                "y": -40
            uuid:
                - 619255fc-e1c2-4b34-bb3e-117534dd46e9
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -750
                "y": -40
        tracking-zmmjmVwcb:
            id: tracking-zmmjmVwcb
            type: tracking
            data:
                scale: "2"
                tracks: true
                type: tracking
            position:
                x: 270
                "y": -40
    - uuid: fb1aa30a-fd38-449d-8194-5aa0b06c7325
      name: Forklift detection
      enabled: true
      framerate: 10
      passhash: []
      links:
        detector-zT2c9R-aJ:
            "true":
                - filter-6zpqgQlUa
            "false": []
        filter-6zpqgQlUa:
            "true":
                - tracking-ejkLsxiiM
            "false": []
        region-G4HI06pAS:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-zT2c9R-aJ
            "false": []
        tracking-ejkLsxiiM:
            "true":
                - region-G4HI06pAS
            "false": []
      blocks:
        detector-zT2c9R-aJ:
            id: detector-zT2c9R-aJ
            type: detector
            data:
                id: 66
                type: detector
            position:
                x: 30
                "y": 100
            uuid:
                - 69316dc5-6129-4b53-bdb5-c403774fd17c
        filter-6zpqgQlUa:
            id: filter-6zpqgQlUa
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - person
                    - forklifts
            position:
                x: 260
                "y": 100
        region-G4HI06pAS:
            id: region-G4HI06pAS
            type: region
            data:
                anchor: 5
                regionnames:
                    - makita_forklift
                type: region
            position:
                x: 730
                "y": 100
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1080
                "y": 100
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -190
                "y": 100
        tracking-ejkLsxiiM:
            id: tracking-ejkLsxiiM
            type: tracking
            data:
                scale: 2
                tracks: true
                type: tracking
            position:
                x: 470
                "y": 100
    - uuid: 387977e7-7177-424c-a59a-22177f8e7010
      name: Front_door_counter
      desc: Counting people entering and leaving tram
      enabled: true
      framerate: 20
      passhash: []
      links:
        SORT-1nHEP8YDM:
            "true":
                - line-crossing-zAC4OHlOm
                - result
            "false": []
        detector-CNH_LQq0l:
            "true":
                - filter-JBZZjh1K5
            "false": []
        filter-JBZZjh1K5:
            "true":
                - script-6NqqcR7pS
            "false": []
        line-crossing-zAC4OHlOm:
            "true":
                - script-uhUdaR8Iy
            "false":
                - script-uhUdaR8Iy
        region-np-YX1o01:
            "true": []
            "false": []
        script-6NqqcR7pS:
            "true":
                - SORT-1nHEP8YDM
            "false": []
        script-uhUdaR8Iy:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-CNH_LQq0l
            "false": []
        tracking-zmmjmVwcb:
            "true": []
            "false": []
      blocks:
        SORT-1nHEP8YDM:
            id: SORT-1nHEP8YDM
            type: extscript
            data:
                desc: SORT
                error: null
                exec: ./sort
                icon: download.png
                id: sort
                name: SORT
                serialize: ""
                transport: ""
                type: extscript
                values: null
                variables:
                    - class: ""
                      data: null
                      default: false
                      desc: ""
                      label: Use prediction on unmatched trackers
                      name: predunm
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: checkbox
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 3
                      desc: ""
                      label: Max predicts without update
                      name: maxpred
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 3
                      desc: ""
                      label: Max unmatches before delete
                      name: maxunm
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                    - class: ""
                      data: null
                      default: 0.4
                      desc: ""
                      label: IOU threshold
                      name: ioutr
                      readonly: false
                      required: false
                      selected: false
                      system: false
                      type: ""
                      value: null
                      width: 0
                version: ""
            position:
                x: 510
                "y": -90
        detector-CNH_LQq0l:
            id: detector-CNH_LQq0l
            type: detector
            data:
                id: 65
                type: detector
            position:
                x: -380
                "y": -41
            uuid:
                - 61aa66f4-76c9-450e-917d-434345de32d5
        filter-JBZZjh1K5:
            id: filter-JBZZjh1K5
            type: filter
            data:
                percentprob: "30"
                type: filter
                types:
                    - head
            position:
                x: -80
                "y": -40
        line-crossing-zAC4OHlOm:
            id: line-crossing-zAC4OHlOm
            type: line-crossing
            data:
                linenames:
                    - front_door_enter
                type: line-crossing
            position:
                x: 780
                "y": -260
        region-np-YX1o01:
            id: region-np-YX1o01
            type: region
            data:
                action: input
                anchor: 5
                regionnames:
                    - car_l
                    - car_r
                    - cars_l
                    - car
                type: region
            position:
                x: 780
                "y": -541
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1530
                "y": -80
        script-6NqqcR7pS:
            id: script-6NqqcR7pS
            type: script
            data:
                id: 3
                type: script
            position:
                x: 210
                "y": -40
            uuid:
                - c701ddf0-dfd6-4577-bcfe-aa1c052481e1
        script-uhUdaR8Iy:
            id: script-uhUdaR8Iy
            type: script
            data:
                id: 13
                type: script
            position:
                x: 1160
                "y": -340
            uuid:
                - 36323989-8d86-4e9a-8d1a-e0f8d3326883
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: -750
                "y": -40
        tracking-zmmjmVwcb:
            id: tracking-zmmjmVwcb
            type: tracking
            data:
                scale: "2"
                tracks: true
                type: tracking
            position:
                x: 500
                "y": -490
    - uuid: 5085881a-52c5-408a-af4e-f28f73a5ffdc
      name: Car_entrance_check
      enabled: true
      framerate: 10
      passhash: []
      links:
        detector-67Dz_JL0U:
            "true":
                - filter-YtTcTujWv
                - filter-QK5NVxYjU
            "false": []
        filter-QK5NVxYjU:
            "true":
                - region-nYaL9bHx_
            "false": []
        filter-YtTcTujWv:
            "true":
                - region-nYaL9bHx_
            "false": []
        region-nYaL9bHx_:
            "true":
                - script-8tVqaRJi6
            "false":
                - result
        script-8tVqaRJi6:
            "true":
                - result
            "false": []
        source:
            "true":
                - detector-67Dz_JL0U
            "false": []
      blocks:
        detector-67Dz_JL0U:
            id: detector-67Dz_JL0U
            type: detector
            data:
                id: 47
                type: detector
            position:
                x: 220
                "y": 100
            uuid:
                - 85cbcd93-bcd6-4d5f-a6da-f5d6930e9abe
        filter-QK5NVxYjU:
            id: filter-QK5NVxYjU
            type: filter
            data:
                percentprob: "25"
                type: filter
                types:
                    - car
            position:
                x: 420
                "y": 180
        filter-YtTcTujWv:
            id: filter-YtTcTujWv
            type: filter
            data:
                percentprob: "60"
                type: filter
                types:
                    - person
            position:
                x: 420
                "y": -80
        region-nYaL9bHx_:
            id: region-nYaL9bHx_
            type: region
            data:
                anchor: 0
                regionnames:
                    - car_entrance_check
                type: region
            position:
                x: 640
                "y": 100
        result:
            id: result
            type: result
            data:
                type: result
            position:
                x: 1140
                "y": 100
        script-8tVqaRJi6:
            id: script-8tVqaRJi6
            type: script
            data:
                id: 19
                type: script
            position:
                x: 900
                "y": -50
            uuid:
                - 0ff58f11-11ad-4a45-bb29-ba210e62f7b2
        source:
            id: source
            type: source
            data:
                type: source
            position:
                x: 0
                "y": 100
